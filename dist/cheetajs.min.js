/*! cheetajs 2013-12-09 */
var $cheeta={};window.$cheeta=$cheeta,$cheeta.model={Model:function(a,b){this.value=void 0,this.bindings={},this.parent=a,this.name=b,this.children={},this.toExpr=function(){for(var a="",b=this;null!=b.parent&&null!=b.name;){var c=b.name.charAt(0);a=(c>="0"&&"9">=c?"["+b.name+"]":"."+b.name)+a,b=b.parent}return a.substring(1)}},ArrayInterceptor:function(a){return{push:function(){var b=this.length,c=Array.prototype.push.apply(this,arguments),d=this.length;$cheeta.model.update(a,d,b);for(var e=b;d>e;e++)a.children[e].value=this[e],$cheeta.model.interceptProp(a.children[e],this,e);return c},pop:function(){var b=this.length,c=Array.prototype.pop.apply(this,arguments),d=this.length;return $cheeta.model.update(a,d,b),c},shift:function(){var b=this.length,c=Array.prototype.shift.apply(this,arguments);a.parent.value[a.name]=this;var d=this.length;return $cheeta.model.update(a,d,b),c},unshift:function(){var b=this.length,c=Array.prototype.unshift.apply(this,arguments);a.parent.value[a.name]=this;var d=this.length;return $cheeta.model.update(a,d,b),c},splice:function(){var b=this.length,c=Array.prototype.splice.apply(this,arguments),d=this.length;$cheeta.model.update(a,d,b);for(var e=b;d>e;e++)a.children[e].value=this[e],$cheeta.model.interceptProp(a.children[e],this,e);return c}}},interceptArray:function(a){if(null!=a.value){var b=new this.ArrayInterceptor(a);for(var c in b){if(a.value[c]==b[c])break;a.value[c]=b[c]}}},update:function(a,b,c){for(var d in a.bindings)for(var e=a.bindings[d],f=0;f<e.length;f++){var g=e[f];g.update&&g.update(b,c)}},bindElement:function(a,b,c){var d=a.children[b];if(void 0===d&&(d=new $cheeta.model.Model,d.name=b,d.parent=a,this.interceptProp(d,a.value,b),a.children[b]=d),null!=c){var e=c.as||b;null==d.bindings[e]&&(d.bindings[e]=[]),d.bindings[e].push(c)}return d.value=void 0==a.value?void 0:null==a.value?null:a.value[b],d},interceptProp:function(a,b,c){if(null!=b){var d=b[c];try{Object.defineProperty(b,c,{set:function(b){var c=a.value;if(c!=b&&(a.value=b,a.isArray&&$cheeta.model.interceptArray(a)),$cheeta.model.update(a,b,c),b instanceof Object)for(var d in a.children){var e=b[d];$cheeta.model.interceptProp(a.children[d],b,d),b[d]=e}},get:function(){return a.value},enumerable:!0,configurable:!0})}catch(e){if(!(e instanceof TypeError))throw e;return}b[c]=d}},findParentModel:function(a,b){for(;a!=$cheeta.model.root;){if(b==a.name||a.bindings&&null!=a.bindings[b])return a;a=a.parent}return a},bind:function(a,b,c){if("$i"==b)for(var d=a.length-1;d>=0;d--)if("$i"==a[d].name)return a[d];if("."===b.charAt(0))for(key in a[0].bindings){b=key+b;break}null==a&&(a=[$cheeta.model.root]);var e=b.split(/\./g);b=e[e.length-1];for(var f=e[0],g=$cheeta.model.root,h=0;h<a.length&&(g=a[h],g=this.findParentModel(g,f),g==$cheeta.model.root);h++);if(1==e.length&&g!==$cheeta.model.root)b=g.name,g=g.parent;else for(var d=g===$cheeta.model.root?0:1;d<e.length-1;d++){if(null==g.children[e[d]]&&null==this.bindElement(g,e[d],null==c?null:{elem:c.elem,attr:"bind"}))return null;g=g.children[e[d]]}return this.bindElement(g,b,c)},init:function(){$cheeta.model.root=new $cheeta.model.Model(null),$cheeta.model.root.value=window}},$cheeta.onload=function(){$cheeta.compiler.compile(),$cheeta.location.init()},$cheeta.on=function(a,b,c){for(var d=a.split(" "),e=0;e<d.length;e++)d[e].length>0&&b.addEventListener(d[e],c,!1)},window.addEventListener("load",$cheeta.onload,!1),$cheeta.directives={"*":[]},$cheeta.directive=function(a,b,c){if(null==b){var d=$cheeta.directives[a];if(null==d&&a.indexOf(".",a.length-1)>-1){var e=$cheeta.directives["*"];a=a.substring(0,a.length-1);for(var f=0;f<e.length;f++)if(0==a.indexOf(e[f].name)||0==a.indexOf("data-"+e[f].name)){d=e[f];break}return d||$cheeta.directive("")}return d}var g=a.indexOf("*",a.length-1);return g>-1?(a=a.substring(0,a.length-1),$cheeta.directives["*"].push({name:a,fn:b,order:c}),$cheeta.directives["*"][1]):$cheeta.directives["data-"+a]=$cheeta.directives[a]={name:a,fn:b,order:c||1e4}},$cheeta.directive.resolveModelRefs=function(a,b,c,d){for(var e=function(e){var f=null==d?null:{elem:a,attr:b,baseAttrName:b.name.substring(0==b.name.indexOf("data-")?5:0,b.name.length-1),update:function(){d.apply(this,[g])}},g=$cheeta.model.bind(c,e,f);return null!=g?g.toExpr():e},f=null,g=!1,h="",i=-1,j=b.value+"",k=0;k<j.length;k++){var l=j.charAt(k);if(null!=f)l==f&&"\\"!=j.charAt(k-1)&&("/"==f&&(g=!0),f=null),h+=l;else if(g)"a">l&&l>"z"&&(g=!1),h+=l;else if(" "==l||"	"==l||"\r"==l||"\n"==l||"!"==l||'"'==l||l>="%"&&"/">=l&&"."!=l||l>=":"&&"?">=l||""==l){if(("'"==l||'"'==l||"/"==l)&&(f=l),i>-1){var m=j.substring(i,k);if("true"!==m&&"false"!==m&&"undefined"!==m&&"null"!==m&&"NaN"!==m&&isNaN(m)){for(var n=k;" "==j.charAt(n);)n++;if("("==j.charAt(n)){var o=m.lastIndexOf(".");o>-1?(h+=e(m.substring(0,o))+".",h+=m.substring(o+1)):h+=m}else h+=e(m)}else h+=m;i=-1}h+=l}else-1==i&&(i=k)}return h.substring(0,h.length-1)},$cheeta.directive.onModelUpdate=function(elem,attr,parentModels,fn){var expr=$cheeta.directive.resolveModelRefs(elem,attr,parentModels,function(model){var val=null;try{val=eval(elem.getAttribute(this.attr.name))}catch(e){}fn.apply(this,[val])});elem.setAttribute(attr.name,expr)},$cheeta.compiler={recursiveCompile:function(a,b,c){if(b){var d=a;1===b.nodeType&&(d=this.compileDirectives(a,b)),b.__isFor_?b.__isFor_=void 0:this.recursiveCompile(d,b.firstChild),c||this.recursiveCompile(a,b.nextSibling)}},compileElem:function(a,b,c){$cheeta.future.evals=[],this.recursiveCompile(a,b,c),this.runFutures()},cleanUpFromModel:function(a){if(null!=a.__$cheeta_models_)for(var b=0;b<a.__$cheeta_models_.length;b++){var c=a.__$cheeta_models_[b];for(var d in c.bindings)for(var e=c.bindings[d],f=0;f<e.length;f++){var g=e[f];g.elem==a&&e.splice(f,1)}}},compileDirectives:function(a,b){this.cleanUpFromModel(b);for(var c=[],d=[],e=0;e<b.attributes.length;e++){var f=b.attributes[e];if(f.specified){var g=f.name.split(".");if(""==g[g.length-1]&&g.pop(),g.length>1)for(var h=0;h<g.length-1;h++)d.push({name:g[h]+".",value:f.value});else c.push(f)}}for(var e=0;e<d.length;e++){var f=d[e];b.setAttribute(f.name,f.value),c.push(b.attributes[f.name])}c=c.sort(function(a,b){function c(a){return null==a?$cheeta.directive("").order:a.order}return c($cheeta.directive(a.name))-c($cheeta.directive(b.name))});for(var e=0;e<c.length;e++){var f=c[e],i=$cheeta.directive(f.name);if(null!=i){var j=i.fn(b,f,a);null!=j&&(null==b.__$cheeta_models_&&(b.__$cheeta_models_=[]),b.__$cheeta_models_=b.__$cheeta_models_.concat(j)),a=(j||[]).concat(a)}if(b.__isFor_)break}return a},compile:function(){$cheeta.model.init(),$cheeta.future=$cheeta.future||{},$cheeta.future.evals=[],$cheeta.location.initRoute(),scripts=document.getElementsByTagName("script");for(var a=0;a<scripts.length;a++){var b=scripts[a];"text/cj-template"===b.getAttribute("type")&&($cheeta.templates[b.getAttribute("id")]=b.innerHTML)}var c=document.documentElement;this.recursiveCompile([],c),this.runFutures()},runFutures:function(){for(var i=0;i<$cheeta.future.evals.length;i++)eval($cheeta.future.evals[i])}},$cheeta.XHR=function(){var a=this.send,b=this.open,c=new XMLHttpRequest;c.open=function(){return b.apply(c,arguments),c},c.send=function(){return a.apply(c,arguments),c};var d=[],e=[],f=[],g=[];return c.onError=function(a){return f.push(a),c},c.onSuccess=function(a){return d.push(a),c},c.onComplete=function(a){return e.push(a),c},c.onStateChange=function(a){g.push(a)},c.onreadystatechange=function(){if(4==c.readyState){if(200<=c.status&&c.status<300)for(var a=0;a<d.length;a++)d[a].apply(c,[c]);else for(var a=0;a<f.length;a++)f[a].apply(c,[c]);for(var a=0;a<e.length;a++)e[a].apply(c,[c])}for(var a=0;a<g.length;a++)g[a].apply(c,[c])},Object.defineProperty(c,"data",{get:function(){return"application/json"==c.getResponseHeader("Content-Type")?JSON.stringify(c.responseText):c.responseText},enumerable:!0,configurable:!0}),c},$cheeta.XHR.prototype=new XMLHttpRequest,$cheeta.location={keyval:{},watchers:{},watch:function(a,b){a instanceof Function&&(b=a,a=""),null==this.watchers[a]&&(this.watchers[a]=[]),this.watchers[a].push(b)},unwatch:function(a,b){b instanceof Function&&(a=b,b="");var c=this.watchers[b];if(null!=c){var d=c.indexOf(a);d>-1&&c.splice(d,1)}},notify:function(a,b,c){var d=this.watchers[a];if(null!=d)for(var e=0;e<d.length;e++)d[e](b,c)},set:function(a,b){void 0==b&&(b=a,a="");var c=this.keyval[a];this.keyval[a]=b,window.location.hash=this.toHash(),this.notify(a,b,c)},toHash:function(){var a=this.keyval[""]||"";for(var b in this.keyval)b.length>0&&(a+=(a.length>0?"&":"")+b+"="+this.keyval[b]);return a},init:function(){var a=this;window.addEventListener("hashchange",function(){var b,c=window.location.hash,d=0,e="",f={};c=c.substring(c.length>1&&"&"==c.charAt(2)?2:1);for(var g=0;g<=c.length;g++)if("&"==c.charAt(g)||g==c.length){if(b=c.substring(d,g),null==a.keyval[e]||a.keyval[e]!=b){var h=a.keyval[e];a.keyval[e]=b,a.notify(e,b,h)}d=g+1,f[e]=!0,e=""}else"="==c.charAt(g)&&(e=c.substring(d,g),d=g+1);for(var e in a.keyval)if(null==f[e]){var h=a.keyval[e];delete a.keyval[e],a.notify(e,null,h)}},!1)},initRoute:function(){$cheeta.directive("route.").fn(document.body,{name:"route.",value:"$cheeta.location.routes"},[])},routes:{}},$cheeta.directive("bind.",function(elem,attr,parentModels){$cheeta.directive("value.").fn(elem,attr,parentModels),$cheeta.on("keydown keyup change",elem,function(e){setTimeout(function(){eval(elem.getAttribute(attr.name)+"='"+elem.value.replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'")},0)})},800),function(){var a=function(a,b,c){for(var d=b.value.split(/ *; */g),e=[],f=0;f<d.length;f++){var g=d[f];split=g.split(/ +as +/g);var h=split[0],i=split.length>1?split[1]:null,j={elem:a,attr:"ctrl",as:i};e.push($cheeta.model.bind(c,h,j))}return e};$cheeta.directive("ctrl.",a,200),$cheeta.directive("model.",a,201)}(),$cheeta.directive("",function(a,b,c){$cheeta.directive.onModelUpdate(a,b,c,function(b){a.setAttribute(this.baseAttrName,b)})},700),$cheeta.directive("for.",function(a,b,c){a.__isFor_=!0;var d,e,f,g=b.value.split(/ +in +/g);d=g[1],e=g[0],g=d.split(/ +as +/g),d=g[0],f=g.length>1?g[1]:null;var h={elem:a,arrayVar:e,arrayName:d,as:f,update:function(a,b){if((a instanceof Object||b instanceof Object)&&(a=null==a?0:a.length,b=null==b?0:b.length),b>a)for(var c=b-1;c>=a;c--){for(var d in i.children[c].bindings)for(var e=i.children[c].bindings[d],f=0;f<e.length;f++){var g=e[f].elem;g.parentNode.removeChild(g)}delete i.children[c]}else if(a>b)for(var h=this.arrayVar,j=this.arrayName,c=b;a>c;c++){var k=this.elem.cloneNode();k.removeAttribute("for."),k.removeAttribute("data-for."),k.setAttribute("model.",j+"."+c+" as "+h+(this.elem.getAttribute("model.")?";"+this.elem.getAttribute("model.").value:"")),k.style.display="",this.elem.parentNode.insertBefore(k,this.elem);var l=new $cheeta.model.Model($cheeta.model.root,"$i");l.toExpr=function(){return c},$cheeta.compiler.compileElem(this.parentModels.concat(l),k,!0)}}},i=$cheeta.model.bind(c,d,h);return h.parentModels=c,a.style.display="none",i.isArray=!0,[i]},100),$cheeta.directive("html.",function(a,b,c){$cheeta.directive.onModelUpdate(a,b,c,function(b){b!=a.innerHTML&&(a.innerHTML=b||"")})},600),$cheeta.directive("init.",function(a,b,c){var d=$cheeta.directive.resolveModelRefs(a,b,c);$cheeta.future.evals.push(d)},700),$cheeta.keyconsts={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,space:32,pause:19,"break":19,capslock:20,escape:27,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,"down arrow":40,insert:45,"delete":46,colon:58,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numlock:144,scrolllock:145,semicolon:186,comma:188,dash:189,dot:190},$cheeta.directive("on*",function(elem,attr,parentModels){var expr=$cheeta.directive.resolveModelRefs(attr.value,attr,parentModels);elem.setAttribute(attr.name,expr);var baseAttrName=attr.name.substring(0==attr.name.indexOf("data-")?7:2,attr.name.length-1),split=baseAttrName.split("-");!function bindEvent(event,key,attrName){var fn=function(e){eval(elem.getAttribute(attrName))};0==event.indexOf("key")?elem.addEventListener(event,function(a){var b=1;if(1==key.length)b=key.charCodeAt(0);else if(b=$cheeta.keyconsts[key],null==b&&(b=parseInt(key),isNaN(b)))throw"unknown key: "+key;a.which==b&&fn.apply(elem,[a])},!1):elem.addEventListener(event,function(a){fn.apply(elem,[a])},!1)}(split[0],split[1],attr.name)},800),$cheeta.directive("route.",function(a,b,c){var d=this;$cheeta.directive.onModelUpdate(a,b,c,function(b){var e=b;null!=d.watchFn&&$cheeta.location.unwatch(d.fn),d.watchFn=$cheeta.location.watch(function(b){var d=0,f=null;for(var g in e)0==b.indexOf(g)&&d<g.length&&(d=g.length,f=e[g]);null!=f&&(new $cheeta.XHR).open("get",f).onSuccess(function(b){a.innerHTML=b.data,$cheeta.compiler.compileElem(c,a)}).send()})})},900),$cheeta.templates={},$cheeta.directive("template.",function(a,b,c){a.innerHTML=$cheeta.templates[b.value]||a.innerHTML;for(var d=a.childNodes,e=0;e<d.length;e++)$cheeta.compiler.compileElem(c,d[e])},900),$cheeta.directive("text.",function(a,b,c){$cheeta.directive.onModelUpdate(a,b,c,function(b){a.innerHTML="",console.log(a),console.log("val:  "+b),console.log("innerhtml: "+a.innerHTML),a.appendChild(document.createTextNode(b||"")),console.log("innerhtml after: "+a.innerHTML)})},600),$cheeta.directive("value.",function(a,b,c){$cheeta.directive.onModelUpdate(a,b,c,function(b){a.value!=b&&(a.value=b||null)})},600);