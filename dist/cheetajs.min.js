/*! cheetajs 2013-11-30 */
var $cheeta={};window.$cheeta=$cheeta,$cheeta.model={Model:function(a,b){return{__children:{},__value:null,__bindings:{},__name:b,__parent:a,get length(){return null==this.__value?0:this.__value.length}}},arrayModel:{push:function(){var a=this.__value.length;this.__value.push.apply(this.__value,arguments);var b=this.__value.length;$cheeta.model.update(this,a,b);for(var c=a;b>c;c++)this[c]=this.__value[c]},pop:function(){var a=this.__value.length;this.__value.pop.apply(this.__value,arguments);var b=this.__value.length;$cheeta.model.update(this,a,b)},splice:function(){var a=this.__value.length;this.__value.splice.apply(this.__value,arguments);var b=this.__value.length;$cheeta.model.update(this,a,b);for(var c=0;c<this.__value.length;c++)this[c]!=this.__value[c]&&(this[c]=this.__value[c])}},extendArray:function(a){for(var b in this.arrayModel)a[b]=this.arrayModel[b];return a},update:function(a,b,c){for(var d in a.__bindings)for(var e=a.__bindings[d],f=0;f<e.length;f++){var g=e[f];g.update(b,c)}},deleteChild:function(a){for(var b in a.__bindings)for(var c=a.__bindings[b],d=0;d<c.length;d++){{c[d]}this.elem.parentNode.removeChild(this.elem)}delete this.__parent.__children[d],delete this.__parent[d]},hasChildren:function(a){for(var b in a.__children)return!0;return!1},bindElement:function(a,b,c){var d=a.__children[b];if(null==d&&(d=new this.Model(a,name),a.__children[b]=d,d.__name=b),null!=c){var e=c.as||b;null==d.__bindings[e]&&(d.__bindings[e]=[]),d.__bindings[e].push(c)}return void 0===a[b]&&(null==a.__parent&&(window[b]=d),Object.defineProperty(a,b,{get length(){return this.__children[b].__value.length},set:function(a){var c=this.__children[b];if(!(a instanceof Object)&&$cheeta.model.hasChildren(c)&&null!=a)throw"Cannot set primitive value for model "+b;var d=c.__value;if(c.__value=a,$cheeta.model.update(c,a,d),a instanceof Object)for(var e in a)c[e]=a[e]},get:function(){var a=this.__children[b];return null==a.__value||a.__value instanceof Object?a:a.__value},enumerable:!0,configurable:!0})),d},toExpr:function(a){for(var b="."+a.__name,c=a.__parent;null!=c.__parent&&null!=c.__name;)b=(c.__name.charAt(0)>="0"&&c.__name.charAt(0)<="9"?"["+c.__name+"]":"."+c.__name)+b,c=c.__parent;return b.substring(1)},bind:function(a,b,c){if("."===b.charAt(0))for(key in a[0].__bindings){b=key+b;break}null==a&&(a=[$cheeta.model.root]);var d=b.split(/\./g);b=d[d.length-1];for(var e=d[0],f=$cheeta.model.root,g=0;g<a.length&&(f=a[g],f=function(a,b){for(;a!=$cheeta.model.root;){for(var c in a.__bindings)if(c==b)return a;a=a.__parent}return a}(f,e),f==$cheeta.model.root);g++);for(var h=f==$cheeta.model.root?0:1;h<d.length-1;h++)null==f[d[h]]&&this.bindElement(f,d[h],null==c?null:{elem:c.elem,attr:"bind"}),f=f[d[h]];return this.bindElement(f,b,c)}},$cheeta.model.root=new $cheeta.model.Model(null,"ROOT"),$cheeta.directives=[],$cheeta.onload=function(){$cheeta.compiler.compile(),$cheeta.location.init()},window.addEventListener("load",$cheeta.onload,!1),$cheeta.compiler={recursiveCompile:function(a,b,c){if(b){var d=a;1===b.nodeType&&(d=this.compileDirectives(a,b)),this.recursiveCompile(d,b.firstChild),c||this.recursiveCompile(a,b.nextSibling)}},findDirective:function(a,b){return a.getAttribute(b+".")||a.getAttribute("data-"+b+".")},compileDirectives:function(a,b){for(var c=0;c<b.attributes.length;c++){var d=b.attributes[c];if(d.specified&&-1!==d.name.indexOf(".",d.name.length-1)){var e=d.name.substring(0,d.name.length-1);0==e.indexOf("data-")&&(e=e.substring("data-".length));var f=$cheeta.directives[e]||$cheeta.directives[""];a=(f(b,d,a,e)||[]).concat(a)}}return a},compile:function(){$cheeta.futureEvals=[],scripts=document.getElementsByTagName("script");for(var i=0;i<scripts.length;i++){var script=scripts[i];"text/cj-template"===script.getAttribute("type")&&($cheeta.templates[script.getAttribute("id")]=script.innerHTML)}var root=document.documentElement;this.recursiveCompile([],root);for(var i=0;i<$cheeta.futureEvals.length;i++)eval($cheeta.futureEvals[i])}},$cheeta.location={keyval:{},watchers:{},watch:function(a,b){a instanceof Function&&(b=a,a=""),null==this.watchers[a]&&(this.watchers[a]=[]),this.watchers[a].push(b)},unwatch:function(a,b){b instanceof Function&&(a=b,b="");var c=this.watchers[b];if(null!=c){var d=c.indexOf(a);d>-1&&c.splice(d,1)}},notify:function(a,b,c){var d=this.watchers[a];if(null!=d)for(var e=0;e<d.length;e++)d[e](b,c)},set:function(a,b){void 0==b&&(b=a,a="");var c=this.keyval[a];this.keyval[a]=b,window.location.hash=this.toHash(),this.notify(a,b,c)},toHash:function(){var a=this.keyval[""]||"";for(var b in this.keyval)b.length>0&&(a+=(a.length>0?"&":"")+b+"="+this.keyval[b]);return a},init:function(){var a=this;window.addEventListener("hashchange",function(){var b,c=window.location.hash,d=0,e="",f={};c=c.substring(c.length>1&&"&"==c.charAt(2)?2:1);for(var g=0;g<=c.length;g++)if("&"==c.charAt(g)||g==c.length){if(b=c.substring(d,g),null==a.keyval[e]||a.keyval[e]!=b){var h=a.keyval[e];a.keyval[e]=b,a.notify(e,b,h)}d=g+1,f[e]=!0,e=""}else"="==c.charAt(g)&&(e=c.substring(d,g),d=g+1);for(var e in a.keyval)if(null==f[e]){var h=a.keyval[e];delete a.keyval[e],a.notify(e,null,h)}},!1)}},$cheeta.directives.ctrl=$cheeta.directives.bind=function(a,b,c){for(var d=b.value.split(/ *; */g),e=[],f=0;f<d.length;f++){var g=d[f];split=g.split(/ +as +/g);var h=split[0],i=split.length>1?split[1]:null,j={elem:a,attr:"ctrl",as:i};null!=a.getAttribute("data-__for.")&&(j.update=function(a){void 0==a&&this.elem.parentNode.removeChild(this.elem)}),e.push($cheeta.model.bind(c,h,j))}return e},$cheeta.futureEvals=[],$cheeta.directives[""]=function(elem,attr,parentModels,baseAttrName){this.parseExpr=function(a,b){var c=null,d=!1,e="",f=-1;a+="";for(var g=0;g<a.length;g++){var h=a.charAt(g);if(null!=c)h==quote&&"\\"!=a.charAt(g-1)&&("/"==quote&&(d=!0),quote=null),e+=h;else if(d)"a">h&&h>"z"&&(d=!1),e+=h;else if(" "==h||"	"==h||"\r"==h||"\n"==h||"!"==h||'"'==h||h>="%"&&"/">=h&&"."!=h||h>=":"&&"?">=h||""==h){if(("'"==h||'"'==h||"/"==h)&&(quote=h),f>-1){var i=a.substring(f,g);e+=b(i),f=-1}e+=h}else-1==f&&(f=g)}return e.substring(0,e.length-1)};var expr=this.parseExpr(attr.value,function(name){var model=$cheeta.model.bind(parentModels,name,"init"===baseAttrName?null:{elem:elem,attr:attr,baseAttrName:baseAttrName,update:function(model){var val=eval(this.elem.getAttribute(this.attr.name));"text"===this.baseAttrName?(this.elem.innerHTML="",this.elem.appendChild(document.createTextNode(val))):"html"===this.baseAttrName?this.elem.innerHTML=val:("value"===this.baseAttrName&&void 0!==this.elem.value&&(this.elem.value=val||null),this.elem.setAttribute(this.baseAttrName,val))}});return null!=model?$cheeta.model.toExpr(model):name});"init"===baseAttrName&&$cheeta.futureEvals.push(expr),elem.setAttribute(attr.name,expr)},$cheeta.futureEvals=[],$cheeta.directives.eval=function(a,b){$cheeta.futureEvals.push(b.value)},$cheeta.directives["for"]=function(a,b,c){var d,e,f,g=b.value.split(/ +in +/g);d=g[1],e=g[0],g=d.split(/ +as +/g),d=g[0],f=g.length>1?g[1]:null;var h={elem:a,arrayVar:e,arrayName:d,as:f,update:function(b,c){if(b instanceof Object&&(c=b.length,b=0),b>c)for(var d=b-1;d>=c;d--)i[d]=null,delete i[d],delete i.__children[d];else if(c>b){var e=this.arrayVar,f=this.arrayName,g=this.elem.getAttribute("bind.")?this.elem.getAttribute("bind.").value:"";g+=this.elem.getAttribute("data-bind.")?this.elem.getAttribute("data-bind.").value:"";for(var d=b;c>d;d++){var h=this.elem.cloneNode();h.removeAttribute("for."),h.removeAttribute("data-for."),h.setAttribute("data-__for."),h.setAttribute("bind.",f+"."+d+" as "+e+(g.length>0?";"+g:"")),h.style.display="",a.parentNode.insertBefore(h,this.elem),$cheeta.compiler.recursiveCompile(this.__parentModels,h,!0)}}}},i=$cheeta.model.bind(c,d,h);return i=$cheeta.model.extendArray(i),h.__parentModels=[i.__parent].concat(c),a.style.display="none",[i]},$cheeta.templates={},$cheeta.directives.template=function(a,b,c){a.innerHTML=$cheeta.templates[b.value]||a.innerHTML;for(var d=a.childNodes,e=0;e<d.length;e++)$cheeta.compiler.recursiveCompile(c,d[e])};